(this["webpackJsonplive-streaming-app"]=this["webpackJsonplive-streaming-app"]||[]).push([[0],{101:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(16),l=a.n(c),o=(a(74),a(75),a(6)),i=a(43),s=a(44),u=a(25),m=a(59),d=a(45),E=a(46),p=a(58),v=a(60),f=a(47),g=a(48),h=a(8),_=a.n(h),b=a(61),S=a.n(b);var y=function(){var e=Object(n.useContext)(z).viewers;return r.a.createElement("tbody",null,e&&e.map((function(e){var t=e.id,a=e.full_name,n=e.phoneNo,c=e.live_token,l=e.is_live;return r.a.createElement("tr",{key:"viewer_".concat(t)},r.a.createElement("td",null,t),r.a.createElement("td",null,a),r.a.createElement("td",null,n),r.a.createElement("td",null,c),r.a.createElement("td",null,l))})))},C=a(62),k=a(63),O=a(68),w=a(67),N=a(33);a(96);N.a.configure();var j=function(e){return function(t){Object(O.a)(n,t);var a=Object(w.a)(n);function n(){var e;Object(C.a)(this,n);for(var t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return(e=a.call.apply(a,[this].concat(r))).TOAST_PROPERTIES={position:"bottom-right",autoClose:3e3,hideProgressBar:!0},e.success=function(t){N.a.success(t,e.TOAST_PROPERTIES)},e.error=function(t){N.a.error(t,e.TOAST_PROPERTIES)},e}return Object(k.a)(n,[{key:"render",value:function(){var t={success:this.success,error:this.error};return r.a.createElement(e,Object.assign({},t,this.props))}}]),n}(r.a.Component)};var T=r.a.memo(j((function(e){var t=e.error,a=e.success,c=Object(n.useContext)(z).dispatchViewers,l=Object(n.useState)(!1),i=Object(o.a)(l,2),m=i[0],p=i[1];return r.a.createElement(s.a,{as:"section"},r.a.createElement(u.a,null,r.a.createElement("div",{className:"m-2"},r.a.createElement("div",{className:S.a.table},r.a.createElement(E.a,{striped:!0,hover:!0,responsive:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"id"),r.a.createElement("th",null,"Fullname"),r.a.createElement("th",null,"Phone number"),r.a.createElement("th",null,"Live token"),r.a.createElement("th",null,"Live"))),m?r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",style:{textAlign:"center"}},"GENERATING TOKENS ",r.a.createElement(g.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})))):r.a.createElement(y,null))),r.a.createElement(s.a,{className:"mt-2",xs:"1",md:"3"},r.a.createElement(u.a,null,r.a.createElement(d.a,{disabled:m,onClick:function(){p(!0),_.a.get("https://secure.comp-rite.co.ke/livestream/setTokens.php").then((function(e){c({type:"FETCH_SUCCESS",payload:e.data}),p(!1),a("Live tokens generated successfully")})).catch((function(e){return t("Error generating tokens: "+e.message)}))},block:!0},"GENERATE TOKENS"))))))}))),x=a(21),R=a.n(x),F=a(64),V=a.n(F);var H=r.a.memo(j((function(e){var t=e.error,a=e.success,c=Object(n.useContext)(I).dispatch,l=Object(n.useState)(""),i=Object(o.a)(l,2),s=i[0],E=i[1],p=Object(n.useState)(""),v=Object(o.a)(p,2),f=v[0],g=v[1];return r.a.createElement(u.a,null,r.a.createElement(m.a,{className:V.a.video_form,onSubmit:function(e){e.preventDefault();var n=Date.now(),r=R()(n,"mediumDate"),l=R()(n,"isoTime");_.a.post("https://secure.comp-rite.co.ke/livestream/addNewVideo.php",{videoLink:s,videoName:f,date:r,created_at:l}).then((function(e){a("Video added successfully"),c({type:"FETCH_SUCCESS",payload:e.data[0]})})).catch((function(e){return t("Error adding video: "+e.message)})),E(""),g("")}},r.a.createElement("fieldset",null,r.a.createElement("legend",null,"Add new video"),r.a.createElement(m.a.Group,{controlId:"form_video_name"},r.a.createElement(m.a.Label,null,"Video Name"),r.a.createElement(m.a.Control,{type:"text",placeholder:"Enter video name",name:"videoName",value:f,onChange:function(e){return g(e.target.value)}})),r.a.createElement(m.a.Group,{controlId:"form_video_link"},r.a.createElement(m.a.Label,null,"Video Link"),r.a.createElement(m.a.Control,{type:"text",placeholder:"Enter video link",name:"videoLink",value:s,onChange:function(e){return E(e.target.value)}})),r.a.createElement(d.a,{type:"submit"},"Set video details"))))}))),A=a(65),D=a(34),L=a.n(D);var P=function(){var e=Object(n.useContext)(I).state.video.video_link,t=Object(n.useState)(!1),a=Object(o.a)(t,2),c=a[0],l=a[1],i=Object(n.useState)(""),m=Object(o.a)(i,2),d=m[0],E=m[1];return Object(n.useEffect)((function(){e?(E(e),l(!0)):(E(""),l(!1))}),[e]),r.a.createElement(r.a.Fragment,null,c?r.a.createElement(s.a,{className:"m-0 mt-5 mt-md-2"},r.a.createElement(u.a,{className:"text-center my-auto p-0"},r.a.createElement("iframe",{title:"Live Preview",className:"w-100 m-0",height:"200px",src:d,frameBorder:"0",allowFullScreen:!0}))):r.a.createElement(s.a,{className:"".concat(L.a.preview_container," m-0 mt-5 mt-md-2")},r.a.createElement(u.a,{className:"".concat(L.a.preview_font," text-center my-auto")},r.a.createElement(A.a,{className:L.a.icon}),r.a.createElement("p",null,"NO VIDEO ADDED"))))};var U=j((function(e){var t=e.error,a=e.success,c=Object(n.useContext)(I),l=c.state.video.is_active,o=c.dispatch;return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{className:"m-0 mt-2"},"false"!==l?r.a.createElement(r.a.Fragment,null,r.a.createElement(u.a,{className:"p-0 mr-1"},r.a.createElement(d.a,{disabled:"pending"!==l,variant:"success",block:!0,onClick:function(){var e=R()(Date.now(),"isoTime");_.a.post("https://secure.comp-rite.co.ke/livestream/startStream.php",{start:e}).then((function(e){o({type:"FETCH_SUCCESS",payload:e.data[0]}),a("Started video successfully")})).catch((function(e){t("Failed starting video "+e.message)}))}},l&&"pending"!==l?"Stream started":"Start stream")),r.a.createElement(u.a,{className:"p-0 ml-1"},r.a.createElement(d.a,{disabled:!l||"false"===l,variant:"danger",block:!0,onClick:function(){var e=R()(Date.now(),"isoTime");_.a.post("https://secure.comp-rite.co.ke/livestream/endStream.php",{end:e}).then((function(e){o({type:"FETCH_SUCCESS",payload:e.data[0]}),a("Ended video successfully")})).catch((function(e){t("Failed ending video "+e.message)}))}},l&&"false"===l?"Stream ended":"End stream"))):r.a.createElement(u.a,{className:"p-0"},r.a.createElement(d.a,{variant:"secondary",block:!0,onClick:function(){_.a.get("https://secure.comp-rite.co.ke/livestream/unstageVideo.php").then((function(e){o({type:"FETCH_SUCCESS",payload:e.data}),a("Video unstaged successfully")})).catch((function(e){t("Failed unstaging video "+e.message)}))}},"Unstage video"))))})),I=r.a.createContext(),G={loading:!0,error:"",video:{}},B=function(e,t){switch(t.type){case"FETCH_SUCCESS":return{loading:!1,error:"",video:t.payload};case"FETCH_ERROR":return{loading:!1,error:t.payload,video:t.payload};default:return e}};var K=r.a.memo((function(){var e=Object(n.useReducer)(B,G),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){_.a.get("https://secure.comp-rite.co.ke/livestream/getVideo.php").then((function(e){e.data.length>0&&c({type:"FETCH_SUCCESS",payload:e.data[0]})})).catch((function(e){console.log("Video table not available: "+e.message),c({type:"FETCH_ERROR",payload:e.message})}))}),[]),r.a.createElement(I.Provider,{value:{state:a,dispatch:c}},r.a.createElement(s.a,{as:"section",xs:1,md:2},r.a.createElement(H,null),r.a.createElement(u.a,null,r.a.createElement(P,null),r.a.createElement(U,null))))})),z=r.a.createContext(),M={loading:!0,error:"",viewers:{}},Y=function(e,t){switch(t.type){case"FETCH_SUCCESS":return{loading:!1,error:"",viewers:t.payload};case"FETCH_ERROR":return{loading:!1,error:t.payload,viewers:t.payload};default:return e}};var q=j((function(e){var t=e.error,a=Object(n.useReducer)(Y,M),c=Object(o.a)(a,2),l=c[0],s=c[1],u=Object(n.useState)(!0),m=Object(o.a)(u,2),d=m[0],E=m[1];return Object(n.useEffect)((function(){_.a.get("https://secure.comp-rite.co.ke/livestream/getViewers.php").then((function(e){s({type:"FETCH_SUCCESS",payload:e.data}),E(!1)})).catch((function(e){t("Failed loading users: "+e.message),s({type:"FETCH_ERROR",payload:e.message})}))}),[t]),!d&&l.viewers?r.a.createElement(z.Provider,{value:{viewers:l.viewers,dispatchViewers:s}},r.a.createElement(i.a,null,r.a.createElement("h4",{className:"mt-5"},"SET VIDEO LINK"),r.a.createElement(K,null),r.a.createElement("h4",{className:"mt-5"},"GENERATE LIVE TOKENS"),r.a.createElement(T,null))):null})),J=a(23),Q=a.n(J),W=a(7);var Z=Object(W.f)((function(e){var t=e.history,a=Object(n.useContext)(ue).viewer,c=a.full_name,l=a.live_token;return r.a.createElement(i.a,{className:"p-0",fluid:!0},r.a.createElement(p.a,{className:"".concat(Q.a.navigation_container," p-0"),bg:"light",expand:"lg"},r.a.createElement(p.a.Brand,{className:"".concat(Q.a.brand," ml-2"),href:"#home"},"LIVE STREAMING APP"),r.a.createElement(p.a.Toggle,{className:"m-2","aria-controls":"basic-navbar-nav"}),r.a.createElement(p.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(v.a,{className:"ml-auto"},r.a.createElement(v.a.Link,{className:"ml-2",as:"span"},c),r.a.createElement(v.a.Item,{className:"".concat(Q.a.separator," mx-2 d-none d-lg-block"),as:"span"}),r.a.createElement(v.a.Link,{className:"".concat(Q.a.logout," ml-2"),onClick:function(){_.a.get("https://secure.comp-rite.co.ke/livestream/logoutViewer.php?token=".concat(l)).then((function(e){})).catch((function(e){return console.log("Logout error",e)})),t.push("/logout")}},"Logout ")))))})),$=a(28),X=a(18),ee=a.n(X),te={loading:!0,error:"",video:{}},ae=function(e,t){switch(t.type){case"FETCH_SUCCESS":return{loading:!1,error:"",video:t.payload};case"FETCH_ERROR":return{loading:!1,error:t.payload,video:t.payload};default:return e}};var ne=r.a.memo((function(){var e=Object(n.useReducer)(ae,te),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(!0),i=Object(o.a)(l,2),m=i[0],d=i[1],E=Object(n.useContext)(ue).viewer.full_name;if(Object(n.useEffect)((function(){_.a.get("https://secure.comp-rite.co.ke/livestream/getVideo.php").then((function(e){c({type:"FETCH_SUCCESS",payload:e.data[0]}),d(!1)})).catch((function(e){c({type:"FETCH_ERROR",payload:e}),console.log("Error obtainig video: ",e.message),d(!1)}))}),[]),m)return null;var p="",v="";a.video?(p=a.video.video_link,v=a.video.is_active):(p="https://www.youtube.com/embed/PUVkwlYKcAc",v="Demo Video");var g={};switch(v){case"pending":g={variant:"secondary",videoStatus:"pending"};break;case"true":g={variant:"success",videoStatus:"live"};break;case"false":g={variant:"danger",videoStatus:"Stream ended"};break;default:g={variant:"warning",videoStatus:"demo video"}}return r.a.createElement(r.a.Fragment,null,r.a.createElement("iframe",{title:"video",className:"".concat(ee.a.video," w-100 m-0"),src:p,frameBorder:"0",scrolling:"no",allow:"autoplay; encrypted-media; picture-in-picture",allowFullScreen:!0}),r.a.createElement(s.a,{xs:1,lg:2,className:"".concat(ee.a.details," m-0")},r.a.createElement(u.a,{className:"p-0"},r.a.createElement(s.a,{className:"m-0"},r.a.createElement(u.a,{className:"".concat(ee.a.separator," p-0 py-2 my-auto"),xs:12,md:4},r.a.createElement(f.a,{className:"".concat(ee.a.pill," py-1 px-3"),pill:!0,variant:g.variant},g.videoStatus)),r.a.createElement(u.a,{className:"".concat(ee.a.separator," ").concat(ee.a.user," p-0 py-2 my-auto"),xs:12,md:8},r.a.createElement($.b,null)," ",E)))))})),re=a(66),ce=a.n(re);var le=function(e){var t=e.handleClick;return r.a.createElement(d.a,{className:ce.a.button,variant:"dark",block:!0,onClick:t},r.a.createElement($.a,{color:"white"})," AGENDA")};var oe=function(e){var t=e.agenda;return r.a.createElement(E.a,{style:{fontSize:"14px"},striped:!0,hover:!0,responsive:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Agenda"),r.a.createElement("th",null,"Question"),r.a.createElement("th",null,"Type"))),r.a.createElement("tbody",null,t?t.map((function(e){var t=e.id,a=e.name,n=e.question,c=e.type;return r.a.createElement("tr",{key:"agenda-".concat(t)},r.a.createElement("td",null,a),r.a.createElement("td",null,n),r.a.createElement("td",null,c))})):null))};var ie=r.a.memo((function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)([]),i=Object(o.a)(l,2),m=i[0],d=i[1],E=Object(n.useCallback)((function(){a||_.a.get("https://secure.comp-rite.co.ke/livestream/getAgenda.php").then((function(e){d(e.data)})).catch((function(e){return console.log("Error obtaining agenda: ",e.message)})),c(!a)}),[a]),p={};return m[0]&&(p.agenda=m),r.a.createElement(s.a,{xs:1},r.a.createElement(u.a,null,r.a.createElement(le,{handleClick:E})),r.a.createElement(u.a,null,a&&r.a.createElement(oe,p)))})),se=a(104),ue=r.a.createContext(),me={loading:!0,error:"",viewer:{}},de=function(e,t){switch(t.type){case"FETCH_SUCCESS":return{loading:!1,error:"",viewer:t.payload};case"FETCH_ERROR":return{loading:!1,error:t.payload,viewer:t.payload};default:return e}};var Ee=j((function(e){var t=e.match.params.token,a=e.history,c=e.error,l=Object(n.useReducer)(de,me),s=Object(o.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(!0),E=Object(o.a)(d,2),p=E[0],v=E[1],f=Object(se.a)(["user_token"]),g=Object(o.a)(f,2),h=g[0],b=g[1];return Object(n.useEffect)((function(){_.a.get("https://secure.comp-rite.co.ke/livestream/getViewer.php?token=".concat(t)).then((function(e){"false"===e.data[0].is_live&&!h.user_token||h.user_token?_.a.get("https://secure.comp-rite.co.ke/livestream/loginViewer.php?token=".concat(t)).then((function(e){var a=new Date,n=new Date(a.setHours(a.getHours()+24));m({type:"FETCH_SUCCESS",payload:e.data[0]}),h.user_token||b("user_token",t,{path:"/",expires:n}),v(!1)})):(m({type:"FETCH_SUCCESS",payload:e.data[0]}),v(!1))})).catch((function(e){c("Failed loading users: "+e.message),m({type:"FETCH_ERROR",payload:e.message}),a.push("/")}))}),[c,h,b,t,a]),!p&&u.viewer?"true"===u.viewer.is_live&&h.user_token?r.a.createElement(r.a.Fragment,null,r.a.createElement(ue.Provider,{value:{viewer:u.viewer}},r.a.createElement(Z,null),r.a.createElement(i.a,{className:"mt-4 text-center",style:{fontSize:0}},r.a.createElement(ne,null),r.a.createElement(ie,null)))):r.a.createElement(i.a,{className:"text-center pt-5"},r.a.createElement("h1",null,"Rejected Connection"),r.a.createElement("p",null,"You are unauthorised to view this page")):null})),pe=a(105),ve=Object(pe.a)((function(e){var t=e.cookies;return Object(n.useEffect)((function(){t.get("user_token")&&t.remove("user_token",{path:"/"})}),[t]),r.a.createElement(i.a,{className:"text-center pt-5"},r.a.createElement("h1",null,"Logout Successful"),r.a.createElement("p",null,"You can login once more by visting the provided link"))})),fe=function(){return r.a.createElement(i.a,{className:"text-center pt-5"},r.a.createElement("h1",null,"404 Not Found"),r.a.createElement("p",null,"The page requested does not exist"))};var ge=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.c,null,r.a.createElement(W.a,{exact:!0,path:"/",component:fe}),r.a.createElement(W.a,{exact:!0,path:"/dashboard",component:q}),r.a.createElement(W.a,{exact:!0,path:"/logout",component:ve}),r.a.createElement(W.a,{path:"/:token",component:Ee})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var he=a(26),_e=a(106);a(100);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_e.a,null,r.a.createElement(he.a,null,r.a.createElement(ge,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},18:function(e,t,a){e.exports={video:"Video_video__37xDL",details:"Video_details__3_NDD",separator:"Video_separator__1GL_t",pill:"Video_pill__36MA3",viewers:"Video_viewers__1ZDQY",user:"Video_user__2ams-"}},23:function(e,t,a){e.exports={navigation_container:"Nav_navigation_container__2ZRD5",brand:"Nav_brand__1bGwa",separator:"Nav_separator__36T9F",logout:"Nav_logout__24koh"}},34:function(e,t,a){e.exports={preview_container:"VideoPreview_preview_container__2KVTo",preview_font:"VideoPreview_preview_font__1MA0E",icon:"VideoPreview_icon__29Tzh"}},61:function(e,t,a){e.exports={table:"GenerateTokens_table__3R6Pn"}},64:function(e,t,a){e.exports={video_form:"VideoForm_video_form__2_iFS"}},66:function(e,t,a){e.exports={button:"ToggleAgenda_button__3nzTu"}},69:function(e,t,a){e.exports=a(101)},74:function(e,t,a){},75:function(e,t,a){}},[[69,1,2]]]);
//# sourceMappingURL=main.be9a0594.chunk.js.map